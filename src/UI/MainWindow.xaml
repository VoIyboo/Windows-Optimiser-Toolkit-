<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Quinn Optimiser Toolkit (V3)"
        Height="720"
        Width="1150"
        Background="#0F172A"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <!-- Theme brushes -->
        <SolidColorBrush x:Key="AccentBrush"        Color="#2563EB"/>
        <SolidColorBrush x:Key="CardBrush"          Color="#020617"/>
        <SolidColorBrush x:Key="CardAltBrush"       Color="#0B1120"/>
        <SolidColorBrush x:Key="BorderBrushMain"    Color="#1F2937"/>
        <SolidColorBrush x:Key="MutedTextBrush"     Color="#9CA3AF"/>

        <SolidColorBrush x:Key="SafeBrush"          Color="#16A34A"/>
        <SolidColorBrush x:Key="CautionBrush"       Color="#F59E0B"/>
        <SolidColorBrush x:Key="DangerBrush"        Color="#DC2626"/>

        <!-- GroupBox style -->
        <Style TargetType="GroupBox">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Margin" Value="8"/>
            <Setter Property="Padding" Value="10"/>
            <Setter Property="Background" Value="{StaticResource CardBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrushMain}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="HeaderTemplate">
                <Setter.Value>
                    <DataTemplate>
                        <TextBlock Text="{Binding}"
                                   Foreground="{StaticResource AccentBrush}"
                                   FontWeight="Bold"/>
                    </DataTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Button style -->
        <Style TargetType="Button">
            <Setter Property="Margin" Value="4"/>
            <Setter Property="Padding" Value="8,4"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Background" Value="{StaticResource AccentBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource AccentBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>

        <!-- Tab styles -->
        <Style TargetType="TabControl">
            <Setter Property="Margin" Value="10"/>
        </Style>

        <Style TargetType="TabItem">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Background" Value="#111827"/>
            <Setter Property="Margin" Value="0,0,2,0"/>
            <Setter Property="Padding" Value="10,4"/>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#FFFFFF"/>
                    <Setter Property="Foreground" Value="{StaticResource AccentBrush}"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- DataGrid base style -->
        <Style TargetType="DataGrid">
            <Setter Property="AutoGenerateColumns" Value="False"/>
            <Setter Property="CanUserAddRows" Value="False"/>
            <Setter Property="GridLinesVisibility" Value="Horizontal"/>
            <Setter Property="HeadersVisibility" Value="Column"/>
            <Setter Property="Background" Value="{StaticResource CardBrush}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrushMain}"/>
            <Setter Property="RowBackground" Value="#0B1120"/>
            <Setter Property="AlternatingRowBackground" Value="#020617"/>
        </Style>

        <!-- DataGrid column headers -->
        <Style TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="#020617"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrushMain}"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
        </Style>

        <!-- DataGrid rows with risk colouring (Apps / Startup) -->
        <Style TargetType="DataGridRow">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrushMain}"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding Risk}" Value="Green">
                    <Setter Property="BorderBrush" Value="{StaticResource SafeBrush}"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Risk}" Value="Amber">
                    <Setter Property="BorderBrush" Value="{StaticResource CautionBrush}"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Risk}" Value="Red">
                    <Setter Property="BorderBrush" Value="{StaticResource DangerBrush}"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Risk}" Value="Protected">
                    <Setter Property="Opacity" Value="0.7"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>   <!-- Header -->
            <RowDefinition Height="*"/>      <!-- Main body -->
            <RowDefinition Height="Auto"/>   <!-- Status bar -->
        </Grid.RowDefinitions>

        <!-- HEADER -->
        <Border Grid.Row="0"
                Background="#020617"
                Padding="10"
                BorderBrush="#111827"
                BorderThickness="0,0,0,1">
            <DockPanel>
                <StackPanel DockPanel.Dock="Left"
                            Orientation="Vertical">
                    <TextBlock Text="Quinn Optimiser Toolkit"
                               FontSize="20"
                               Foreground="White"
                               FontWeight="Bold"/>
                    <TextBlock x:Name="SummaryText"
                               Text="Loading system summary..."
                               Foreground="{StaticResource MutedTextBrush}"
                               FontSize="11"/>
                </StackPanel>

                <StackPanel DockPanel.Dock="Right"
                            Orientation="Horizontal"
                            VerticalAlignment="Center">
                    <!-- Theme picker -->
                    <TextBlock Text="Theme:"
                               Foreground="White"
                               Margin="0,0,5,0"
                               VerticalAlignment="Center"/>
                    <ComboBox x:Name="ThemeCombo"
                              Width="130"
                              Margin="0,0,15,0"
                              SelectedIndex="0">
                        <ComboBoxItem Content="Dark"/>
                        <ComboBoxItem Content="Light"/>
                        <ComboBoxItem Content="Auto"/>
                    </ComboBox>

                    <!-- Accent colour (just UI for now) -->
                    <TextBlock Text="Accent:"
                               Foreground="White"
                               Margin="0,0,5,0"
                               VerticalAlignment="Center"/>
                    <ComboBox x:Name="AccentCombo"
                              Width="130"
                              Margin="0,0,15,0"
                              SelectedIndex="0">
                        <ComboBoxItem Content="Blue (default)"/>
                        <ComboBoxItem Content="Green"/>
                        <ComboBoxItem Content="Purple"/>
                        <ComboBoxItem Content="Orange"/>
                    </ComboBox>

                    <!-- Mode preset -->
                    <TextBlock Text="Mode:"
                               Foreground="White"
                               Margin="0,0,5,0"
                               VerticalAlignment="Center"/>
                    <ComboBox x:Name="ModeCombo"
                              Width="190"
                              SelectedIndex="0">
                        <ComboBoxItem Content="Custom selection"/>
                        <ComboBoxItem Content="Safe optimise"/>
                        <ComboBoxItem Content="Performance boost"/>
                        <ComboBoxItem Content="Privacy hardened"/>
                        <ComboBoxItem Content="Full debloat (advanced)"/>
                        <ComboBoxItem Content="Company standard build"/>
                    </ComboBox>
                </StackPanel>
            </DockPanel>
        </Border>

        <!-- MAIN TABS -->
        <TabControl x:Name="MainTabs"
                    Grid.Row="1">

            <!-- DASHBOARD TAB -->
<TabItem Header="Dashboard">
  <Grid Margin="5,20,5,5">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
    </Grid.RowDefinitions>
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="3*"/>
      <ColumnDefinition Width="2*"/>
    </Grid.ColumnDefinitions>

    <!-- Top summary tiles -->
    <StackPanel Grid.Row="0" Grid.ColumnSpan="2" Orientation="Horizontal" Margin="0,0,0,10">
      <!-- CPU / RAM -->
      <Border Background="#020617" Padding="10" Margin="0,0,10,0"
              BorderBrush="#374151" BorderThickness="1" Width="260">
        <StackPanel>
          <TextBlock Text="CPU / RAM"
                     Foreground="#9CA3AF"
                     FontSize="11"/>
          <TextBlock x:Name="CpuRamText"
                     Text="CPU: 0%   RAM: 0%"
                     Foreground="White"
                     FontSize="14"
                     FontWeight="Bold"
                     Margin="0,4,0,0"/>
        </StackPanel>
      </Border>

      <!-- Disk usage -->
      <Border Background="#020617" Padding="10" Margin="0,0,10,0"
              BorderBrush="#374151" BorderThickness="1" Width="260">
        <StackPanel>
          <TextBlock Text="Disk usage (C:)"
                     Foreground="#9CA3AF"
                     FontSize="11"/>
          <TextBlock x:Name="DiskUsageText"
                     Text="0 GB used / 0 GB free"
                     Foreground="White"
                     FontSize="14"
                     FontWeight="Bold"
                     Margin="0,4,0,0"/>
        </StackPanel>
      </Border>

      <!-- System health -->
      <Border Background="#020617" Padding="10"
              BorderBrush="#374151" BorderThickness="1" Width="260">
        <StackPanel>
          <TextBlock Text="System health"
                     Foreground="#9CA3AF"
                     FontSize="11"/>
          <TextBlock x:Name="SystemHealthText"
                     Text="Waiting for scan..."
                     Foreground="White"
                     FontSize="14"
                     FontWeight="Bold"
                     Margin="0,4,0,0"/>
        </StackPanel>
      </Border>
    </StackPanel>

    <!-- Left side: storage + maintenance -->
    <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,0,10,0">
      <!-- Storage overview -->
      <GroupBox Header="Storage overview" Margin="0,0,0,10">
        <Grid>
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="*"/>
          </Grid.ColumnDefinitions>

          <StackPanel Grid.Column="0" Margin="0,0,10,0">
            <TextBlock Text="Largest folders (C:)" Foreground="#9CA3AF" Margin="0,0,0,4"/>
            <ListView x:Name="LargestFoldersList"
                      Background="#020617"
                      Foreground="White"
                      BorderBrush="#374151"
                      BorderThickness="1"
                      Height="170">
              <ListView.View>
                <GridView>
                  <GridViewColumn Header="Folder" DisplayMemberBinding="{Binding Name}" Width="180"/>
                  <GridViewColumn Header="Size (GB)" DisplayMemberBinding="{Binding SizeGB}" Width="80"/>
                </GridView>
              </ListView.View>
            </ListView>
          </StackPanel>

          <StackPanel Grid.Column="1">
            <TextBlock Text="Largest installed apps" Foreground="#9CA3AF" Margin="0,0,0,4"/>
            <ListView x:Name="LargestAppsList"
                      Background="#020617"
                      Foreground="White"
                      BorderBrush="#374151"
                      BorderThickness="1"
                      Height="170">
              <ListView.View>
                <GridView>
                  <GridViewColumn Header="App" DisplayMemberBinding="{Binding Name}" Width="180"/>
                  <GridViewColumn Header="Size (MB)" DisplayMemberBinding="{Binding SizeMB}" Width="80"/>
                </GridView>
              </ListView.View>
            </ListView>
          </StackPanel>
        </Grid>
      </GroupBox>

      <!-- Maintenance summary -->
      <GroupBox Header="Maintenance summary">
        <StackPanel>
          <TextBlock Text="Last maintenance run:" Foreground="#9CA3AF"/>
          <TextBlock x:Name="LastMaintenanceText"
                     Text="Never run"
                     Foreground="White"
                     Margin="0,2,0,8"/>

          <TextBlock Text="Recommended quick actions:" Foreground="#9CA3AF" Margin="0,0,0,2"/>
          <TextBlock x:Name="QuickActionsText"
                     Text="Run a scan to get recommendations."
                     Foreground="White"
                     TextWrapping="Wrap"/>
        </StackPanel>
      </GroupBox>
    </StackPanel>

    <!-- Right side: Quinn recommendations -->
    <GroupBox Grid.Row="1" Grid.Column="1" Header="Quinn recommendations">
      <DockPanel>
        <StackPanel DockPanel.Dock="Top" Margin="0,0,0,10">
          <TextBlock Text="Run a scan to generate personalised recommendations for this device."
                     TextWrapping="Wrap"
                     Foreground="White"
                     Margin="0,0,0,8"/>
          <Button x:Name="RecommendButton"
                  Content="Analyse system and refresh recommendations"
                  Width="260"
                  HorizontalAlignment="Left"/>
        </StackPanel>
      </DockPanel>
    </GroupBox>

  </Grid>
</TabItem>

            <!-- TWEAKS & CLEANING TAB -->
            <TabItem Header="Tweaks &amp; Cleaning">
                <Grid Margin="8,18,8,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Cleaning -->
                    <GroupBox Header="Cleaning &amp; maintenance"
                              Grid.Row="0"
                              Grid.Column="0">
                        <StackPanel>
                            <CheckBox x:Name="CbCleanWU"
                                      Content="Clean Windows Update cache"
                                      Foreground="{StaticResource SafeBrush}"
                                      Margin="3"/>
                            <CheckBox x:Name="CbCleanDO"
                                      Content="Clean Delivery Optimisation cache"
                                      Foreground="{StaticResource SafeBrush}"
                                      Margin="3"/>
                            <CheckBox x:Name="CbTemp"
                                      Content="Clear temp folders"
                                      Foreground="{StaticResource SafeBrush}"
                                      Margin="3"/>
                            <CheckBox x:Name="CbWinSxS"
                                      Content="WinSxS safe cleanup"
                                      Foreground="{StaticResource CautionBrush}"
                                      Margin="3"/>
                            <CheckBox x:Name="CbWinOld"
                                      Content="Remove Windows.old (if present)"
                                      Foreground="{StaticResource CautionBrush}"
                                      Margin="3"/>
                            <CheckBox x:Name="CbLogs"
                                      Content="Clear logs, dumps and old restore points"
                                      Foreground="{StaticResource CautionBrush}"
                                      Margin="3"/>
                        </StackPanel>
                    </GroupBox>

                    <!-- Tweaks -->
                    <GroupBox Header="UI, privacy and performance tweaks"
                              Grid.Row="0"
                              Grid.Column="1">
                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                            <StackPanel>
                                <CheckBox x:Name="CbT_StartMenuRec"   Content="Disable Start menu recommendations"                              Foreground="{StaticResource SafeBrush}"    Margin="3"/>
                                <CheckBox x:Name="CbT_SuggestedApps"  Content="Disable suggested apps and Microsoft promotional content"        Foreground="{StaticResource CautionBrush}" Margin="3"/>
                                <CheckBox x:Name="CbT_Widgets"        Content="Turn off Widgets"                                             Foreground="{StaticResource CautionBrush}" Margin="3"/>
                                <CheckBox x:Name="CbT_News"           Content="Turn off News &amp; Interests"                                Foreground="{StaticResource CautionBrush}" Margin="3"/>
                                <CheckBox x:Name="CbT_BackgroundApps" Content="Limit or disable background apps"                             Foreground="{StaticResource SafeBrush}"    Margin="3"/>
                                <CheckBox x:Name="CbT_Animations"     Content="Reduce / disable animations"                                  Foreground="{StaticResource SafeBrush}"    Margin="3"/>
                                <CheckBox x:Name="CbT_Tips"           Content="Disable online tips and suggestions"                          Foreground="{StaticResource SafeBrush}"    Margin="3"/>
                                <CheckBox x:Name="CbT_AdId"           Content="Disable advertising ID"                                      Foreground="{StaticResource SafeBrush}"    Margin="3"/>
                                <CheckBox x:Name="CbT_Feedback"       Content="Disable Feedback Hub prompts"                                Foreground="{StaticResource SafeBrush}"    Margin="3"/>
                                <CheckBox x:Name="CbT_Telemetry"      Content="Set telemetry to safe/minimal"                               Foreground="{StaticResource CautionBrush}" Margin="3"/>
                                <CheckBox x:Name="CbT_MeetNow"        Content="Turn off Meet Now"                                          Foreground="{StaticResource SafeBrush}"    Margin="3"/>
                                <CheckBox x:Name="CbT_Cortana"        Content="Disable Cortana leftovers"                                  Foreground="{StaticResource SafeBrush}"    Margin="3"/>
                                <CheckBox x:Name="CbT_StockApps"      Content="Remove unused stock apps (3D Viewer, Mixed Reality Portal, etc)" Foreground="{StaticResource CautionBrush}" Margin="3"/>
                                <CheckBox x:Name="CbT_StartupSound"   Content="Turn off startup sound"                                     Foreground="{StaticResource SafeBrush}"    Margin="3"/>
                                <CheckBox x:Name="CbT_SnapAssist"     Content="Customise / disable Snap Assist"                             Foreground="{StaticResource SafeBrush}"    Margin="3"/>
                                <CheckBox x:Name="CbT_MouseAccel"     Content="Turn off mouse acceleration"                                 Foreground="{StaticResource SafeBrush}"    Margin="3"/>
                                <CheckBox x:Name="CbT_HiddenFiles"    Content="Show hidden files and file extensions"                       Foreground="{StaticResource SafeBrush}"    Margin="3"/>
                                <CheckBox x:Name="CbT_VerboseLogon"   Content="Enable verbose logon messages"                               Foreground="{StaticResource SafeBrush}"    Margin="3"/>
                                <CheckBox x:Name="CbT_GameDVR"        Content="Disable GameDVR / Game Bar"                                 Foreground="{StaticResource SafeBrush}"    Margin="3"/>
                                <CheckBox x:Name="CbT_AppReinstall"   Content="Stop Windows from reinstalling built-in apps after updates" Foreground="{StaticResource CautionBrush}" Margin="3"/>
                            </StackPanel>
                        </ScrollViewer>
                    </GroupBox>

                    <GroupBox Header="Notes"
                              Grid.Row="1"
                              Grid.ColumnSpan="2">
                        <TextBlock TextWrapping="Wrap"
                                   Foreground="{StaticResource MutedTextBrush}">
                            Green items are safe and reversible. Amber items should be used with a restore point and a basic understanding of the impact.
                            High-risk or deeper changes live in the Advanced tab.
                        </TextBlock>
                    </GroupBox>
                </Grid>
            </TabItem>

            <!-- APPS TAB -->
            <TabItem Header="Apps">
                <Grid Margin="8,18,8,8">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Top controls -->
                    <StackPanel Grid.Row="0"
                                Orientation="Horizontal"
                                Margin="0,0,0,6">
                        <Button x:Name="BtnScanApps"
                                Content="Rescan installed apps"
                                Width="170"/>
                        <Button x:Name="BtnUninstallSelected"
                                Content="Uninstall selected"
                                Width="170"
                                Margin="5,0,0,0"/>
                        <TextBlock Text="  Green = safe, Amber = caution, Red = system/experts only. Whitelisted apps cannot be selected."
                                   Foreground="{StaticResource MutedTextBrush}"
                                   VerticalAlignment="Center"
                                   Margin="10,0,0,0"/>
                    </StackPanel>

                    <!-- Two even halves -->
                    <Grid Grid.Row="1">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Installed apps -->
                        <GroupBox Header="Installed apps"
                                  Grid.Row="0"
                                  Margin="0,0,0,4">
                            <DataGrid x:Name="AppsGrid">
                                <DataGrid.Columns>
                                    <DataGridTemplateColumn Header="Select" Width="60">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <CheckBox IsChecked="{Binding IsSelected}"
                                                          IsEnabled="{Binding IsSelectable}"
                                                          HorizontalAlignment="Center"/>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                    <DataGridTextColumn Header="Name"      Binding="{Binding Name}"       Width="*"/>
                                    <DataGridTextColumn Header="Publisher" Binding="{Binding Publisher}"  Width="220"/>
                                    <DataGridTextColumn Header="Size (MB)" Binding="{Binding SizeMB}"     Width="90"/>
                                    <DataGridTextColumn Header="Installed" Binding="{Binding InstallDate, StringFormat=d}" Width="110"/>
                                    <DataGridTextColumn Header="Risk"      Binding="{Binding Risk}"       Width="90"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </GroupBox>

                        <!-- Install apps -->
                        <GroupBox Header="Install common apps (winget)"
                                  Grid.Row="1"
                                  Margin="0,4,0,0">
                            <DataGrid x:Name="InstallGrid">
                                <DataGrid.Columns>
                                    <DataGridCheckBoxColumn Header="Select"
                                                            Width="60"
                                                            Binding="{Binding IsSelected}"/>
                                    <DataGridTextColumn Header="Name"
                                                        Width="*"
                                                        Binding="{Binding Name}"/>
                                    <DataGridTextColumn Header="Status"
                                                        Width="180"
                                                        Binding="{Binding Status}"/>
                                    <DataGridTemplateColumn Header="Install"
                                                            Width="90">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Button Content="Install"
                                                        Padding="4,1"
                                                        Margin="2"/>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </GroupBox>
                    </Grid>
                </Grid>
            </TabItem>

            <!-- STARTUP TAB -->
            <TabItem Header="Startup">
                <Grid Margin="8,18,8,8">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,6">
                        <Button x:Name="BtnRefreshStartup"
                                Content="Rescan startup items"
                                Width="180"/>
                        <TextBlock Text=" Manage startup programs. High-risk or system items are protected by default."
                                   Foreground="{StaticResource MutedTextBrush}"
                                   VerticalAlignment="Center"
                                   Margin="10,0,0,0"/>
                    </StackPanel>

                    <GroupBox Header="Startup programs" Grid.Row="1">
                        <DataGrid x:Name="StartupGrid">
                            <DataGrid.Columns>
                                <DataGridCheckBoxColumn Header="Enabled"
                                                        Width="80"
                                                        Binding="{Binding IsEnabled}"/>
                                <DataGridTextColumn Header="Name"      Binding="{Binding Name}"      Width="*"/>
                                <DataGridTextColumn Header="Location"  Binding="{Binding Location}"  Width="260"/>
                                <DataGridTextColumn Header="Impact"    Binding="{Binding Impact}"    Width="110"/>
                                <DataGridTextColumn Header="Risk"      Binding="{Binding Risk}"      Width="90"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </GroupBox>
                </Grid>
            </TabItem>

            <!-- SCHEDULER TAB -->
            <TabItem Header="Scheduler">
                <Grid Margin="8,18,8,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <GroupBox Header="Scheduled maintenance"
                              Grid.Column="0">
                        <StackPanel>
                            <TextBlock Text="Configure automatic clean-ups using Task Scheduler."
                                       Foreground="{StaticResource MutedTextBrush}"
                                       Margin="0,0,0,6"/>
                            <CheckBox x:Name="CbScheduleWeekly"
                                      Content="Run weekly maintenance (temp, update cache, logs)"
                                      Margin="3"/>
                            <CheckBox x:Name="CbScheduleMonthly"
                                      Content="Run monthly deep maintenance"
                                      Margin="3"/>
                            <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
                                <TextBlock Text="Preferred run time:"
                                           Foreground="{StaticResource MutedTextBrush}"
                                           VerticalAlignment="Center"/>
                                <TextBox x:Name="TxtScheduleTime"
                                         Width="80"
                                         Margin="6,0,0,0"
                                         Text="02:00"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                                <Button x:Name="BtnApplySchedule"
                                        Content="Apply schedule"/>
                                <Button x:Name="BtnRemoveSchedule"
                                        Content="Remove all toolkit schedules"
                                        Margin="6,0,0,0"/>
                            </StackPanel>
                        </StackPanel>
                    </GroupBox>

                    <GroupBox Header="Schedule status"
                              Grid.Column="1">
                        <StackPanel>
                            <TextBlock Text="Current tasks:"
                                       Foreground="{StaticResource MutedTextBrush}"
                                       Margin="0,0,0,4"/>
                            <ListView x:Name="ScheduleStatusList"
                                      Background="{StaticResource CardAltBrush}"
                                      BorderBrush="{StaticResource BorderBrushMain}">
                                <!-- Items: Name / Next run -->
                            </ListView>
                            <TextBlock Text="Toolkit uses standard Windows Task Scheduler. No services or background agents are installed."
                                       TextWrapping="Wrap"
                                       Foreground="{StaticResource MutedTextBrush}"
                                       Margin="0,6,0,0"/>
                        </StackPanel>
                    </GroupBox>
                </Grid>
            </TabItem>

            <!-- QUICK TOOLS TAB -->
            <TabItem Header="Quick tools">
                <Grid Margin="8,18,8,8">
                    <UniformGrid Rows="3" Columns="3">
                        <Button x:Name="BtnQuickTemp"
                                Content="Clear temp files"/>
                        <Button x:Name="BtnQuickRestartExplorer"
                                Content="Restart Explorer"/>
                        <Button x:Name="BtnQuickFlushDns"
                                Content="Flush DNS cache"/>
                        <Button x:Name="BtnQuickWSReset"
                                Content="Clear Microsoft Store cache"/>
                        <Button x:Name="BtnQuickResetNetwork"
                                Content="Reset network adapters (safe preset)"/>
                        <Button x:Name="BtnQuickRepairWU"
                                Content="Repair Windows Update components"/>
                        <Button x:Name="BtnQuickOpenLogs"
                                Content="Open toolkit log folder"/>
                        <Button x:Name="BtnQuickSystemInfo"
                                Content="Open System Information"/>
                        <Button x:Name="BtnQuickEventViewer"
                                Content="Open Event Viewer (Application + System)"/>
                    </UniformGrid>
                </Grid>
            </TabItem>

            <!-- ADVANCED TAB -->
            <TabItem Header="Advanced">
                <Grid Margin="8,18,8,8">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <GroupBox Header="Advanced cleaning &amp; profiles"
                              Grid.Row="0"
                              Grid.Column="0">
                        <StackPanel>
                            <CheckBox x:Name="CbAdvProfiles"
                                      Content="Remove old user profiles (keep current + admin accounts)"
                                      Foreground="{StaticResource CautionBrush}"
                                      Margin="3"/>
                            <CheckBox x:Name="CbAdvRestore"
                                      Content="Aggressive restore point / log cleanup"
                                      Foreground="{StaticResource DangerBrush}"
                                      Margin="3"/>
                            <CheckBox x:Name="CbAdvDeepCache"
                                      Content="Deep cache cleanup (WinSxS / component store)"
                                      Foreground="{StaticResource DangerBrush}"
                                      Margin="3"/>
                        </StackPanel>
                    </GroupBox>

                    <GroupBox Header="Network &amp; services"
                              Grid.Row="0"
                              Grid.Column="1">
                        <StackPanel>
                            <CheckBox x:Name="CbAdvNet"
                                      Content="General network tweaks (DNS / MTU / offloads)"
                                      Foreground="{StaticResource CautionBrush}"
                                      Margin="3"/>
                            <CheckBox x:Name="CbAdvIPv6"
                                      Content="Disable IPv6 on non-tunnel adapters"
                                      Foreground="{StaticResource DangerBrush}"
                                      Margin="3"/>
                            <CheckBox x:Name="CbAdvTeredo"
                                      Content="Disable Teredo and 6to4 tunnels"
                                      Foreground="{StaticResource DangerBrush}"
                                      Margin="3"/>
                            <CheckBox x:Name="CbAdvServices"
                                      Content="Service optimisation (non-essential services only)"
                                      Foreground="{StaticResource CautionBrush}"
                                      Margin="3"/>
                            <CheckBox x:Name="CbAdvSearchIndex"
                                      Content="Reduce or disable Windows Search indexing"
                                      Foreground="{StaticResource CautionBrush}"
                                      Margin="3"/>
                        </StackPanel>
                    </GroupBox>

                    <GroupBox Header="Warnings"
                              Grid.Row="1"
                              Grid.ColumnSpan="2">
                        <TextBlock TextWrapping="Wrap"
                                   Foreground="{StaticResource DangerBrush}">
                            All advanced options are high risk and intended for experienced users.
                            Always create a backup and a restore point before applying changes on this tab.
                        </TextBlock>
                    </GroupBox>
                </Grid>
            </TabItem>

        </TabControl>

        <!-- STATUS BAR -->
        <Border Grid.Row="2"
                Background="#020617"
                Padding="6"
                BorderBrush="#111827"
                BorderThickness="1,1,1,0">
            <DockPanel>
                <StackPanel DockPanel.Dock="Left"
                            Orientation="Horizontal">
                    <TextBlock Text="Status: "
                               Foreground="{StaticResource MutedTextBrush}"/>
                    <TextBlock x:Name="StatusLabel"
                               Text="Idle"
                               Foreground="White"/>
                </StackPanel>
                <StackPanel DockPanel.Dock="Right"
                            Orientation="Horizontal">
                    <Button x:Name="RunButton"
                            Content="Run selected actions"
                            Margin="0,0,10,0"
                            Width="170"/>
                    <ProgressBar x:Name="MainProgress"
                                 Width="220"
                                 Height="16"
                                 Minimum="0"
                                 Maximum="100"
                                 Value="0"/>
                </StackPanel>
            </DockPanel>
        </Border>
    </Grid>
</Window>
